<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang chủ - HotelBooking</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="../favicon.ico" type="image/x-icon">
    <style>
        /* --- GIỮ NGUYÊN CSS CŨ --- */
        body { font-family: 'Poppins', sans-serif; background-color: #f8f9fa; }
        .navbar { box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .hero-section { background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://images.unsplash.com/photo-1571896349842-6e53ce41e8f2?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80'); background-size: cover; background-position: center; padding: 80px 0 100px 0; color: white; margin-bottom: -50px; }
        .search-container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); position: relative; z-index: 10; }
        .form-label { color: #333; font-weight: 600; }
        .hotel-card { border: none; border-radius: 15px; transition: all 0.3s ease; background: white; height: 100%; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.05); cursor: pointer; }
        .hotel-card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.15); }
        .card-img-wrapper { position: relative; height: 200px; overflow: hidden; }
        .card-img-top { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease; }
        .hotel-card:hover .card-img-top { transform: scale(1.1); }
        .rating-badge { position: absolute; top: 15px; right: 15px; background: #ffc107; color: #000; padding: 5px 10px; border-radius: 8px; font-weight: bold; font-size: 0.9rem; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .carousel-item img, .carousel-item div { border-radius: 15px; }
        .section-title { position: relative; display: inline-block; margin-bottom: 30px; font-weight: 700; color: #2c3e50; }
        .section-title::after { content: ''; display: block; width: 50%; height: 3px; background: #0d6efd; margin: 5px auto 0; border-radius: 2px; }
        .main-footer { background-color: #f2f2f2; color: #333; padding-top: 60px; padding-bottom: 40px; font-size: 0.95rem; }
        .footer-heading { font-weight: 700; text-transform: uppercase; margin-bottom: 20px; font-size: 1rem; color: #212529; }
        .footer-links { list-style: none; padding: 0; }
        .footer-links li { margin-bottom: 12px; }
        .footer-links a { color: #555; text-decoration: none; transition: color 0.2s; }
        .footer-links a:hover { color: #0d6efd; padding-left: 5px; }
        .company-info p { margin-bottom: 8px; color: #666; font-size: 0.9rem; }
        .logo-icon { font-size: 3rem; color: #5a67d8; margin-bottom: 20px; display: inline-block; }

        /* --- CSS MỚI --- */
        .reason-box { border: 1px solid #eee; border-radius: 8px; padding: 20px; height: 100%; transition: 0.3s; background: white; }
        .reason-box:hover { box-shadow: 0 5px 15px rgba(0,0,0,0.05); border-color: #0d6efd; }
        
        .review-section { background-color: #fff; padding: 40px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.03); }
        .review-highlight { background-color: #f0f7ff; padding: 20px; border-left: 4px solid #0d6efd; font-style: italic; color: #555; border-radius: 4px; margin: 15px 0; font-size: 1.05rem; }
        
        .nav-pills .nav-link { color: #6c757d; background-color: transparent; border: 1px solid #e9ecef; border-radius: 50px; margin: 0 5px 10px 5px; padding: 8px 20px; font-weight: 500; transition: all 0.3s; }
        .nav-pills .nav-link.active, .nav-pills .nav-link:hover { background-color: #0d6efd; color: white; border-color: #0d6efd; box-shadow: 0 4px 10px rgba(13, 110, 253, 0.3); }

        .location-item { position: relative; border-radius: 12px; overflow: hidden; height: 200px; cursor: pointer; }
        .location-item img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s; }
        .location-item:hover img { transform: scale(1.1); }
        .location-name { position: absolute; bottom: 0; left: 0; width: 100%; background: linear-gradient(transparent, rgba(0,0,0,0.8)); color: white; padding: 15px; text-align: center; font-weight: 700; font-size: 1.1rem; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top py-3">
        <div class="container">
            <a class="navbar-brand fw-bold fs-4" href="home.html"><i class="fa-solid fa-hotel me-2"></i>HotelBooking</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <div class="ms-auto">
                    <a href="/BLOG/blog.html" class="btn btn-outline-light me-2 rounded-pill px-3">BLOG</a>
                    <a href="/Client/help.html" class="btn btn-outline-light me-2 rounded-pill px-3">
                        <i class="fa-solid fa-circle-question me-1"></i> Trợ giúp
                    </a>
                    <a href="register.html" class="btn btn-outline-light me-2 rounded-pill px-3">Đăng ký</a>
                    <a href="login.html" class="btn btn-outline-light me-2 rounded-pill px-3">Đăng nhập</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="hero-section text-center">
        <div class="container">
            <h1 class="display-4 fw-bold mb-3">Đi đâu đi đó, có Hotel Booking lo</h1>
            <p class="lead mb-5">Khám phá những điểm đến tuyệt vời và ưu đãi khách sạn tốt nhất</p>
        </div>
    </div>
    <div class="container">
        <div class="search-container">
            <h2 class="display-5 text-center fw-bold mb-2">Bạn lựa chọn khách sạn nào?</h2>
            <p class="lead text-center mb-4">Hàng nghìn khách sạn với mức giá tốt nhất đang chờ bạn!</p>
            <form id="search-form" class="row g-3 align-items-end">
                <div class="col-md-4">
                    <label for="area" class="form-label"><i class="fa-solid fa-map-location-dot me-2 text-primary"></i>Bạn muốn đi đâu?</label>
                    <select id="area" class="form-select form-select-lg"><option value ="" selected>-- Chọn Khu Vực --</option></select>
                </div>
                <div class="col-md-3">
                    <label for="checkin" class="form-label"><i class="fa-solid fa-calendar-check me-2 text-primary"></i>Ngày nhận phòng</label>
                    <input type="date" id="checkin" class="form-control form-control-lg">
                </div>
                <div class="col-md-3">
                    <label for="checkout" class="form-label"><i class="fa-solid fa-calendar-xmark me-2 text-primary"></i>Ngày trả phòng</label>
                    <input type="date" id="checkout" class="form-control form-control-lg">
                </div>
                <div class="col-md-2">
                    <button type="button" class="btn btn-primary btn-lg w-100 fw-bold shadow-sm" onclick="searchHotels()">
                        <i class="fa-solid fa-magnifying-glass me-2"></i>Tìm
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div class="container mt-5 pt-4">
        <div class="row align-items-center mb-3">
            <div class="col-md-8"><h3 class="fw-bold text-dark mb-0"><i class="fa-solid fa-fire text-danger me-2"></i>Ưu đãi hot mùa này</h3><p class="text-muted">Nhanh tay đặt ngay để nhận giá tốt nhất</p></div>
        </div>
        <div id="adCarousel" class="carousel slide shadow rounded-4" data-bs-ride="carousel" data-bs-interval="5000">
            <div class="carousel-inner rounded-4">
                <div class="carousel-item active"><div class="d-block w-100" style="height: 350px; background: url('https://ducmanhsuncloud.click/Hotel/Slide/pic1.jpg') center center / cover no-repeat;"></div></div>
                <div class="carousel-item"><div class="d-block w-100" style="height: 350px; background: url('https://ducmanhsuncloud.click/Hotel/Slide/pic2.jpg') center center / cover no-repeat;"></div></div>
                <div class="carousel-item"><div class="d-block w-100" style="height: 350px; background: url('https://ducmanhsuncloud.click/Hotel/Slide/pic3.jpg') center center / cover no-repeat;"></div></div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#adCarousel" data-bs-slide="prev"><span class="carousel-control-prev-icon"></span></button>
            <button class="carousel-control-next" type="button" data-bs-target="#adCarousel" data-bs-slide="next"><span class="carousel-control-next-icon"></span></button>
        </div>
    </div>

    <div class="container mt-5">
        <h3 class="fw-bold mb-4">Vì sao lại chọn HotelBooking?</h3>
        <div class="row g-4">
            <div class="col-md-3">
                <div class="reason-box">
                    <div class="mb-3 text-primary"><i class="fa-solid fa-calendar-check fa-2x"></i></div>
                    <h6 class="fw-bold">Đặt bây giờ, thanh toán tại chỗ nghỉ</h6>
                    <p class="small text-muted mb-0">MIỄN PHÍ hủy cho hầu hết các phòng</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="reason-box">
                    <div class="mb-3 text-warning"><i class="fa-solid fa-thumbs-up fa-2x"></i></div>
                    <h6 class="fw-bold">Hơn 300 triệu đánh giá từ khách khác</h6>
                    <p class="small text-muted mb-0">Tham khảo thông tin đáng tin cậy từ du khách như bạn</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="reason-box">
                    <div class="mb-3 text-success"><i class="fa-solid fa-earth-americas fa-2x"></i></div>
                    <h6 class="fw-bold">Hơn 2 triệu chỗ nghỉ toàn cầu</h6>
                    <p class="small text-muted mb-0">Khách sạn, guest house, căn hộ và nhiều loại chỗ ở khác...</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="reason-box">
                    <div class="mb-3 text-info"><i class="fa-solid fa-headset fa-2x"></i></div>
                    <h6 class="fw-bold">Dịch vụ khách hàng đáng tin cậy, 24/7</h6>
                    <p class="small text-muted mb-0">Chúng tôi luôn sẵn sàng giúp đỡ bạn</p>
                </div>
            </div>
        </div>
    </div>

    <div class="container mt-5">
        <div class="row align-items-center">
            <div class="col-lg-4 mb-4 mb-lg-0">
                <h2 class="fw-bold display-6">Đánh giá từ những người đã trải nghiệm</h2>
                <p class="text-muted">Khách hàng chia sẻ về những kỷ niệm tuyệt vời trên chuyến du lịch với chúng tôi.</p>
                <div class="fs-1 text-info opacity-50"><i class="fa-solid fa-quote-left"></i></div>
            </div>
            <div class="col-lg-8">
                <div class="review-section">
                    <div class="tab-content" id="pills-tabContent">
                        <div class="tab-pane fade show active" id="pills-review1" role="tabpanel">
                            <h5 class="fw-bold text-dark">Du thuyền Heritage Bình Chuẩn</h5>
                            <p class="text-secondary mt-2 mb-1">Cảm ơn team đã tư vấn nhiệt tình cho gia đình mình.</p>
                            <div class="review-highlight">"Tàu đẹp, mang đậm phong cách Á Đông. Đồ ăn hợp khẩu vị. Các bạn nhân viên trên tàu nhiệt tình và chu đáo."</div>
                            <p class="fw-bold text-uppercase mt-3 mb-0 text-primary">- Chị Thu Hà -</p>
                        </div>
                        <div class="tab-pane fade" id="pills-review2" role="tabpanel">
                            <h5 class="fw-bold text-dark">Vinpearl Resort & Spa Phú Quốc</h5>
                            <p class="text-secondary mt-2 mb-1">Kỳ nghỉ tuyệt vời nhất từ trước đến nay!</p>
                            <div class="review-highlight">"Không gian sang trọng, hồ bơi riêng rất sạch. Bãi biển đẹp và nhân viên cực kỳ thân thiện. Sẽ quay lại."</div>
                            <p class="fw-bold text-uppercase mt-3 mb-0 text-primary">- Anh Khánh -</p>
                        </div>
                        <div class="tab-pane fade" id="pills-review3" role="tabpanel">
                            <h5 class="fw-bold text-dark">InterContinental Đà Nẵng</h5>
                            <p class="text-secondary mt-2 mb-1">Dịch vụ đẳng cấp 5 sao thực sự.</p>
                            <div class="review-highlight">"View biển tuyệt đẹp từ phòng. Nhà hàng Citron có món ăn Việt Nam rất ngon. Chuyến đi trăng mật đáng nhớ."</div>
                            <p class="fw-bold text-uppercase mt-3 mb-0 text-primary">- Chị Linh & Anh Dũng -</p>
                        </div>
                    </div>
                    <hr class="my-4">
                    <div class="d-flex justify-content-center flex-wrap">
                        <ul class="nav nav-pills" id="pills-tab" role="tablist">
                            <li class="nav-item"><button class="nav-link active" data-bs-toggle="pill" data-bs-target="#pills-review1" type="button">Chị Thu Hà</button></li>
                            <li class="nav-item"><button class="nav-link" data-bs-toggle="pill" data-bs-target="#pills-review2" type="button">Anh Khánh</button></li>
                            <li class="nav-item"><button class="nav-link" data-bs-toggle="pill" data-bs-target="#pills-review3" type="button">Chị Linh - Anh Dũng</button></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container my-5">
        <div class="text-center p-5 bg-white rounded-4 shadow-sm border border-light">
            <i class="fa-solid fa-quote-left text-primary fs-3 mb-3 opacity-50"></i>
            <h4 class="mb-3 text-secondary" style="line-height: 1.6; font-weight: 300;">
                "Khám phá và trải nghiệm tất cả dịch vụ tuyệt vời từ các khách sạn trên mọi miền đất nước cùng <span class="fw-bold text-primary">HotelBooking</span>."
            </h4>
            <i class="fa-solid fa-quote-right text-primary fs-3 mt-1 opacity-50"></i>
        </div>
    </div>

    <div class="container mt-5 mb-5">
        <div id="filter-section" class="filter-box mb-4" style="display: none;">
            <div class="d-flex align-items-center justify-content-between flex-wrap gap-3">
                <div>
                    <h5 class="mb-0 fw-bold"><i class="fa-solid fa-filter me-2 text-primary"></i>Lọc kết quả</h5>
                    <small class="text-muted" id="filter-subtitle">Đang hiển thị kết quả tại...</small>
                </div>
                <div class="d-flex align-items-center">
                    <label for="price-select" class="me-3 fw-bold text-nowrap">Khoảng giá (Triệu VNĐ):</label>
                    <select id="price-select" class="form-select me-2" style="width: 200px;">
                        <option value="">-- Tất cả --</option>
                        </select>
                    <button class="btn btn-outline-primary fw-bold" onclick="filterHotelsByPrice()">
                        Áp dụng
                    </button>
                </div>
            </div>
        </div>

        <div class="text-center">
            <h2 class="section-title" id="list-title">Những khách sạn 5⭐ hàng đầu</h2>
        </div>
        
        <div id="hotel-list" class="row g-4">
            <div class="text-center py-5">
                <div class="spinner-border text-primary" role="status"></div>
                <p class="mt-2 text-muted">Đang tải dữ liệu...</p>
            </div>
        </div>

        <div class="text-center mt-4" id="view-toggle-container" style="display: none;">
            <button id="toggle-hotels-btn" class="btn btn-outline-primary rounded-pill px-5 fw-bold" onclick="toggleHotelsView()">
                Xem tất cả <i class="fa-solid fa-angle-down ms-1"></i>
            </button>
        </div>
    </div>

    <div class="container mb-5 pb-4">
        <div class="text-center mb-4">
            <h3 class="fw-bold">Khám phá những địa điểm du lịch nổi bật</h3>
            <p class="text-muted">Gợi ý những điểm đến hấp dẫn nhất Việt Nam</p>
        </div>
        <div class="row g-3">
            <div class="col-md-4 col-6"><div class="location-item" onclick="window.location.href='/BLOG/hanoi.html'"><img src="https://fridayshopping.vn/wp-content/uploads/2022/02/top-30-danh-lam-thang-canh-ha-noi-dong-khach-nhat-hien-nay-thumb.jpeg" alt="Hà Nội"><div class="location-name">Hà Nội</div></div></div>
            <div class="col-md-4 col-6"><div class="location-item" onclick="window.location.href='/BLOG/thanhhoa.html'"><img src="https://file.36.com.vn/medias/slider/du-lich-thanh-pho-thanh-hoa-36.com.vn-5.jpg" alt="Thanh Hóa"><div class="location-name">Thanh Hóa</div></div></div>
            <div class="col-md-4 col-6"><div class="location-item" onclick="window.location.href='/BLOG/tphcm.html'"><img src="https://th.bing.com/th/id/R.24d85d2d2d5e007039e85cd76afb71c0?rik=k7QLyEFFGqwOcg&riu=http%3a%2f%2fmuine-explorer.com%2fupload%2fimages%2fdia-diem-check-in-noi-tieng-o-sai-gon.png&ehk=CbPWlAw6kLMUB0YWDCoCNC7Ycv3megjvR4stc4N7LuQ%3d&risl=&pid=ImgRaw&r=0" alt="Sài Gòn"><div class="location-name">TP. Hồ Chí Minh</div></div></div>
            <div class="col-md-4 col-6"><div class="location-item" onclick="window.location.href='/BLOG/danang.html'"><img src="https://phongma.vn/wp-content/uploads/2018/06/30-dia-diem-du-lich-da-nang-du-la-van-chua-het-hot-trong-nam-2017-phan-1-1.jpg" alt="Đà Nẵng"><div class="location-name">Đà Nẵng</div></div></div>
            <div class="col-md-4 col-6"><div class="location-item" onclick="window.location.href='/BLOG/vungtau.html'"><img src="https://dimg04.c-ctrip.com/images/0M76t120009mulszv49A4.webp" alt="Vũng Tàu"><div class="location-name">Vũng Tàu</div></div></div>
            <div class="col-md-4 col-6"><div class="location-item" onclick="window.location.href='/BLOG/phuquoc.html'"><img src="https://noibaitaxitour.com/wp-content/uploads/2021/10/kinh-nghiem-du-lich-phu-quoc.jpg" alt="Phú Quốc"><div class="location-name">Phú Quốc</div></div></div>
        </div>
    </div>

    <footer class="main-footer mt-auto">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-md-6 mb-4 company-info">
                    <div class="text-center text-md-start"><i class="fa-solid fa-hotel me-2"></i></div>
                    <h5 class="fw-bold mb-3">Công ty TNHH Du lịch và Dịch vụ HotelBooking</h5>
                    <p>Số nhà 25, ngõ 276, đường Minh Khai, Xã An Khánh, TP. Hà Nội</p>
                    <p>Mã số doanh nghiệp: 0110376372 do Sở Kế hoạch và Đầu tư Thành phố Hà Nội cấp ngày 05/06/2023</p>
                    <p class="mt-3"><i class="fa-solid fa-phone me-2 text-primary"></i> 0392203920</p>
                    <p><i class="fa-solid fa-envelope me-2 text-primary"></i> contact@hotelbooking.vn</p>
                </div>
                <div class="col-lg-3 col-md-6 mb-4"><h6 class="footer-heading">GIỚI THIỆU</h6><ul class="footer-links"><li><a href="/BLOG/about.html">Về chúng tôi</a></li><li><a href="/BLOG/terms.html">Điều khoản và điều kiện</a></li><li><a href="/BLOG/privacy.html">Chính sách riêng tư</a></li><li><a href="/BLOG/guide.html">Hướng dẫn sử dụng</a></li><li><a href="/BLOG/payment.html">Hình thức thanh toán</a></li></ul></div>
                <div class="col-lg-2 col-md-6 mb-4"><h6 class="footer-heading">ĐIỂM ĐẾN</h6><ul class="footer-links"><li><a href="/BLOG/hanoi.html">Hà Nội</a></li><li><a href="/BLOG/thanhhoa.html">Thanh Hóa</a></li><li><a href="/BLOG/tphcm.html">Thành phố Hồ Chí Minh</a></li><li><a href="/BLOG/danang.html">Đà Nẵng</a></li><li><a href="/BLOG/phuquoc.html">Phú Quốc</a></li><li><a href="/BLOG/vungtau.html">Vũng Tàu</a></li></ul></div>
                <div class="col-lg-3 col-md-6 mb-4"><h6 class="footer-heading">CÂU HỎI THƯỜNG GẶP</h6><ul class="footer-links"><li><a href="/BLOG/blog.html">Blog du lịch</a></li><li><a href="/BLOG/terms.html">Quy định chung và lưu ý</a></li></ul></div>
            </div>
            <div class="text-center pt-4 mt-4 border-top border-secondary-subtle"><p class="mb-0 small text-muted">&copy; 2024 HotelBooking. All rights reserved.</p></div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let allHotelsData = [];
        let isExpanded = false; 

        async function loadAreasFromApi() {
            try {
                const response = await fetch('https://api.ducmanhsuncloud.click/hotels/areas');
                if (!response.ok) throw new Error("Không thể tải danh sách khu vực");
                const areas = await response.json();
                const selectElement = document.getElementById("area");
                areas.forEach(area => {
                    const areaName = (typeof area === 'object') ? area.name : area;
                    if (areaName) {
                        const option = document.createElement("option");
                        option.value = areaName;
                        option.textContent = areaName;
                        selectElement.appendChild(option);
                    }
                });
            } catch (error) { console.error("Lỗi khi tải khu vực:", error); }
        }

        async function fetchHotels(queryParams = "") {
            try {
                let response = await fetch(`https://api.ducmanhsuncloud.click/hotels/5_stars${queryParams}`);
                let hotels = await response.json();
                
                allHotelsData = hotels;
                isExpanded = false; 

                displayHotels(hotels.slice(0, 6));

                const btnContainer = document.getElementById("view-toggle-container");
                const btn = document.getElementById("toggle-hotels-btn");
                if (hotels.length > 6) {
                    btnContainer.style.display = "block";
                    btn.innerHTML = 'Xem tất cả <i class="fa-solid fa-angle-down ms-1"></i>';
                } else {
                    btnContainer.style.display = "none";
                }
                document.getElementById("filter-section").style.display = "none";

            } catch (error) {
                console.error("Lỗi khi tải danh sách khách sạn:", error);
                document.getElementById("hotel-list").innerHTML = `<div class="col-12 text-center text-danger">Lỗi tải dữ liệu. Vui lòng thử lại sau.</div>`;
            }
        }
        async function loadPriceRanges() {
            try {
                const response = await fetch('https://api.ducmanhsuncloud.click/hotels/prices');
                if (!response.ok) throw new Error("Không thể tải danh sách giá");

                const data = await response.json();
                const priceSelect = document.getElementById("price-select");

                // Map data và loại bỏ trùng lặp/null
                let priceList = data
                    .map(item => item.hotel_price)
                    .filter((value, index, self) => value && self.indexOf(value) === index); 

                // Sắp xếp giá tăng dần
                priceList.sort((a, b) => {
                    return parseInt(a) - parseInt(b);
                });

                priceSelect.innerHTML = '<option value="">-- Tất cả mức giá --</option>';
                priceList.forEach(priceStr => {
                    const option = document.createElement("option");
                    option.value = priceStr;
                    option.textContent = priceStr;
                    priceSelect.appendChild(option);
                });
            } catch (error) {
                console.error("Lỗi khi tải khoảng giá:", error);
            }
        }
        function toggleHotelsView() {
            const btn = document.getElementById("toggle-hotels-btn");
            if (!isExpanded) {
                displayHotels(allHotelsData);
                btn.innerHTML = 'Thu gọn <i class="fa-solid fa-angle-up ms-1"></i>';
                isExpanded = true;
            } else {
                displayHotels(allHotelsData.slice(0, 6));
                btn.innerHTML = 'Xem tất cả <i class="fa-solid fa-angle-down ms-1"></i>';
                isExpanded = false;
                document.getElementById('filter-section').scrollIntoView({ behavior: 'smooth' });
            }
        }

        function displayHotels(hotels) {
            let hotelList = document.getElementById("hotel-list");
            hotelList.innerHTML = ""; 
            if (!hotels || hotels.length === 0) {
                 hotelList.innerHTML = `<div class="col-12 text-center py-5"><p class="text-muted fs-5">Không tìm thấy khách sạn phù hợp.</p></div>`;
                 return;
            }
            hotels.forEach(hotel => {
                let hotelCard = document.createElement("div");
                hotelCard.className = "col-md-4"; 
                hotelCard.innerHTML = `
                    <div class="card hotel-card h-100" onclick="redirectToHotel(${hotel.id})">
                        <div class="card-img-wrapper">
                            <img src="${hotel.image_url}" class="card-img-top" alt="${hotel.name}">
                            <div class="rating-badge"><i class="fa-solid fa-star text-white me-1" style="font-size:0.8em"></i>${hotel.rate}</div>
                        </div>
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title fw-bold text-dark mb-2">${hotel.name}</h5>
                            <div class="mb-2 text-muted small"><i class="fa-solid fa-location-dot me-2 text-danger"></i>${hotel.address}</div>
                            <div class="mt-auto pt-3 border-top">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="text-success small"><i class="fa-solid fa-circle-check me-1"></i>${hotel.status}</div>
                                    <div class="text-primary fw-bold"><i class="fa-solid fa-phone me-1"></i> ${hotel.hotline}</div>
                                </div>
                            </div>
                        </div>
                    </div>`;
                hotelList.appendChild(hotelCard);
            });
        }

        // HÀM LỌC GIÁ
        async function filterHotelsByPrice() {
            const selectedPrice = document.getElementById("price-select").value;
            const currentArea = document.getElementById("area").value; 
            
            if (!selectedPrice || selectedPrice === "all") {
                await searchHotels();
                return;
            }

            // 2. Hiển thị Loading
            document.getElementById("hotel-list").innerHTML = `
                <div class="text-center py-5">
                    <div class="spinner-border text-primary" role="status"></div>
                    <p class="mt-2 text-muted">Đang lọc theo mức giá...</p>
                </div>`;
            
            // Ẩn nút "Xem tất cả" trong lúc đang tải
            document.getElementById("view-toggle-container").style.display = "none";

            try {
                // 3. Gọi API Lọc theo giá
                const response = await fetch('https://api.ducmanhsuncloud.click/hotels/prices', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        hotel_price: selectedPrice,
                        area: currentArea 
                    })
                });

                if (!response.ok) throw new Error(`Lỗi server: ${response.status}`);

                const result = await response.json();
                
                // Xử lý dữ liệu trả về (API có thể trả về mảng trực tiếp hoặc object {data: []})
                let hotels = [];
                if (Array.isArray(result)) {
                    hotels = result;
                } else if (result.data && Array.isArray(result.data)) {
                    hotels = result.data;
                }

                // 4. Cập nhật biến toàn cục allHotelsData để nút "Xem tất cả" hoạt động đúng với dữ liệu mới
                allHotelsData = hotels;
                isExpanded = false; // Reset trạng thái về thu gọn

                // 5. Cập nhật tiêu đề hiển thị
                const priceLabel = document.getElementById("price-select").options[document.getElementById("price-select").selectedIndex].text;
                const areaTitle = currentArea ? `tại ${currentArea}` : "";
                document.getElementById("list-title").textContent = `Kết quả lọc: ${priceLabel} ${areaTitle}`;

                // 6. Hiển thị dữ liệu (Chỉ hiện 6 cái đầu tiên)
                displayHotels(hotels.slice(0, 6));

                // 7. Xử lý hiển thị nút "Xem tất cả" nếu kết quả lọc > 6
                const btnContainer = document.getElementById("view-toggle-container");
                const btn = document.getElementById("toggle-hotels-btn");
                
                if (hotels.length > 6) {
                    btnContainer.style.display = "block";
                    btn.innerHTML = 'Xem tất cả <i class="fa-solid fa-angle-down ms-1"></i>';
                } else {
                    btnContainer.style.display = "none";
                }

            } catch (error) {
                console.error("Lỗi khi lọc giá:", error);
                document.getElementById("hotel-list").innerHTML = `<div class="col-12 text-center text-danger">Lỗi lọc dữ liệu. Vui lòng thử lại.</div>`;
            }
        }

        function redirectToHotel(hotelId) {
            const token = localStorage.getItem("access_token");
            if (token) {
                window.location.href = `hotel_info.html?hotel_id=${hotelId}`;
            } else {
                if(confirm("Vui lòng đăng nhập để xem chi tiết và đặt phòng. Chuyển đến trang đăng nhập?")) window.location.href = "login.html";
            }
        }

        async function searchHotels() {
            let area = document.getElementById("area").value;
            let checkin = document.getElementById("checkin").value;
            let checkout = document.getElementById("checkout").value;
            if (!checkin && !checkout) {
                alert("Vui lòng chọn ngày nhận phòng và ngày trả phòng.");
                return;
            }
            const vietnamTimeOffset = 7 * 60; 
            const currentDate = new Date();
            const vietnamDate = new Date(currentDate.getTime() + vietnamTimeOffset * 60 * 1000);
            const currentDateFormatted = vietnamDate.toISOString().split('T')[0];
            if (checkin && checkout && checkin >= checkout) { alert("Ngày trả phòng phải sau ngày nhận phòng."); return; }
            if (checkin && checkin < currentDateFormatted) { alert("Ngày đặt phòng phải lớn hơn ngày hiện tại."); return; }
            const titleElement = document.getElementById("list-title");
            if (area) titleElement.textContent = `Danh sách khách sạn tại ${area}`;
            else titleElement.textContent = "Kết quả tìm kiếm";
            
            sessionStorage.setItem('user_checkin', checkin);
            sessionStorage.setItem('user_checkout', checkout);
            
            try {
                let response = await fetch("https://api.ducmanhsuncloud.click/hotels/find", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ area: area, check_in: checkin, check_out: checkout })
                });
                if (!response.ok) throw new Error(`Lỗi từ server: ${response.status}`);
                let hotels = await response.json();
                
                allHotelsData = hotels;
                displayHotels(hotels);
                
                // Ẩn nút xem thêm (vì search hiện hết)
                document.getElementById("view-toggle-container").style.display = "none";
                
                // HIỆN BỘ LỌC VÀ CUỘN XUỐNG
                document.getElementById("filter-section").style.display = "block";
                document.getElementById("filter-section").scrollIntoView({ behavior: 'smooth' });

            } catch (error) {
                console.error("Lỗi khi tìm khách sạn:", error);
                document.getElementById("hotel-list").innerHTML = `<div class="col-12 text-center text-danger"><i class="fa-solid fa-triangle-exclamation fa-3x mb-3"></i><p>Lỗi: ${error.message}</p></div>`;
            }
        }

        document.addEventListener("DOMContentLoaded", function() {
            fetchHotels();      
            loadAreasFromApi();
            loadPriceRanges(); 
        });
    </script>
</body>
</html>